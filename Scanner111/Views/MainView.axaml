<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Scanner111.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="Scanner111.Views.MainView"
             x:DataType="vm:MainWindowViewModel"
             Background="#1E1E1E">
    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
         to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <Grid RowDefinitions="*,Auto">
        <TabControl Grid.Row="0" Background="#1E1E1E">
            <!-- Main Tab -->
            <TabItem Header="Main">
                <Grid RowDefinitions="Auto,*" Margin="10">
                    <!-- Top Action Buttons Section -->
                    <Grid Grid.Row="0" RowDefinitions="Auto,Auto" Margin="0,0,0,10">
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10" Spacing="10">
                            <Button Content="Scan Crash Logs" Command="{Binding ScanCrashLogsCommand}" />
                            <Button Content="Scan Game Files" Command="{Binding ScanGameFilesCommand}" />
                        </StackPanel>
                        
                        <!-- Pastebin Download Section -->
                        <Grid Grid.Row="1" ColumnDefinitions="*,Auto">
                            <TextBox Grid.Column="0" 
                                     Text="{Binding PastebinUrl}" 
                                     Watermark="Enter Pastebin URL or ID"
                                     Margin="0,0,10,0" />
                            <Button Grid.Column="1" 
                                    Content="Download from Pastebin" 
                                    Command="{Binding DownloadFromPastebinCommand}" />
                        </Grid>
                    </Grid>
                    
                    <!-- Output Section -->
                    <Grid Grid.Row="1" RowDefinitions="*,Auto">
                        <!-- Output Text Box -->
                        <TextBox Grid.Row="0" 
                                 Text="{Binding OutputText}" 
                                 IsReadOnly="True" 
                                 AcceptsReturn="True" 
                                 TextWrapping="Wrap"
                                 FontFamily="Consolas, Courier New, Monospace"
                                 ScrollViewer.VerticalScrollBarVisibility="Auto" />
                        
                        <!-- Progress Indicator -->
                        <ProgressBar Grid.Row="1" 
                                     IsVisible="{Binding IsTaskRunning}" 
                                     IsIndeterminate="{Binding IsTaskIndeterminate}"
                                     Value="{Binding TaskProgress}"
                                     Maximum="100"
                                     Height="20"
                                     Margin="0,10,0,0" />
                    </Grid>
                </Grid>
            </TabItem>
            
            <!-- Settings Tab -->
            <TabItem Header="Settings">
                <ScrollViewer>
                    <Grid RowDefinitions="Auto,Auto,Auto,Auto" Margin="20" MaxWidth="600">
                        <!-- Folder Selection Section -->
                        <Grid Grid.Row="0" RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,20">
                            <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" 
                                       Text="Folder Paths" 
                                       FontWeight="Bold" 
                                       Margin="0,0,0,10" 
                                       FontSize="16"/>
                            
                            <!-- INI Files Path -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="INI Files:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding IniFilesPath}" Margin="0,5" />
                            <Button Grid.Row="1" Grid.Column="2" Content="Browse" Command="{Binding BrowseIniPathCommand}" Margin="10,0,0,0"/>
                            
                            <!-- Mods Path -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Mods Folder:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding ModsFolderPath}" Margin="0,5" />
                            <Button Grid.Row="2" Grid.Column="2" Content="Browse" Command="{Binding BrowseModsPathCommand}" Margin="10,0,0,0"/>
                            
                            <!-- Custom Scan Path -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Custom Scan:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding CustomScanPath}" Margin="0,5" />
                            <Button Grid.Row="3" Grid.Column="2" Content="Browse" Command="{Binding BrowseCustomScanPathCommand}" Margin="10,0,0,0"/>
                        </Grid>
                        
                        <!-- Game Settings Section -->
                        <Grid Grid.Row="1" RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*" Margin="0,0,0,20">
                            <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" 
                                       Text="Game Settings" 
                                       FontWeight="Bold" 
                                       Margin="0,0,0,10" 
                                       FontSize="16"/>
                            
                            <!-- Game Selection -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Game:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox Grid.Row="1" Grid.Column="1" 
                                      ItemsSource="{Binding GameOptions}" 
                                      SelectedItem="{Binding SelectedGame}"
                                      HorizontalAlignment="Stretch" />
                        </Grid>
                        
                        <!-- Options Section -->
                        <Grid Grid.Row="2" RowDefinitions="Auto,Auto" Margin="0,0,0,20">
                            <TextBlock Grid.Row="0" 
                                       Text="Options" 
                                       FontWeight="Bold" 
                                       Margin="0,0,0,10" 
                                       FontSize="16"/>
                            
                            <StackPanel Grid.Row="1" Orientation="Vertical" Spacing="5">
                                <CheckBox Content="FCX Mode" IsChecked="{Binding IsFcxModeEnabled}" ToolTip.Tip="Enable FCX Mode compatibility" />
                                <CheckBox Content="Simplify Logs" IsChecked="{Binding IsSimplifyLogsEnabled}" ToolTip.Tip="Simplify the output logs" />
                                <CheckBox Content="Update Check on Startup" IsChecked="{Binding IsUpdateCheckEnabled}" ToolTip.Tip="Check for updates when the application starts" />
                                <CheckBox Content="VR Mode" IsChecked="{Binding IsVrModeEnabled}" ToolTip.Tip="Enable VR Mode compatibility" />
                                <CheckBox Content="Debug Mode" IsChecked="{Binding IsDebugModeEnabled}" ToolTip.Tip="Enable additional debug output" />
                            </StackPanel>
                        </Grid>
                        
                        <!-- Backup Settings Section -->
                        <Grid Grid.Row="3" RowDefinitions="Auto,Auto" Margin="0,0,0,10">
                            <TextBlock Grid.Row="0" 
                                       Text="Backup Settings" 
                                       FontWeight="Bold" 
                                       Margin="0,0,0,10" 
                                       FontSize="16"/>
                            
                            <StackPanel Grid.Row="1" Orientation="Vertical" Spacing="5">
                                <CheckBox Content="Create Backups Before Changes" IsChecked="{Binding IsBackupBeforeChangesEnabled}" ToolTip.Tip="Create backups before making changes to files" />
                                <Button Content="Clear All Backup Files" Command="{Binding ClearBackupFilesCommand}" HorizontalAlignment="Left" Margin="0,10,0,0" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </TabItem>
            
            <!-- Articles Tab -->
            <TabItem Header="Articles">
                <ScrollViewer>
                    <StackPanel Margin="20" MaxWidth="600">
                        <TextBlock Text="Knowledge Base Articles" 
                                   FontWeight="Bold" 
                                   Margin="0,0,0,15" 
                                   FontSize="16"/>
                        
                        <!-- Articles Sections -->
                        <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="*,*" Margin="0,0,0,20">
                            <!-- General Guides Section -->
                            <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,20">
                                <TextBlock Text="General Guides" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <Button Content="Crash Log Analysis Guide" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="CrashLogGuide"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Game Setup Guide" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="GameSetupGuide"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Mod Troubleshooting" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="ModTroubleshooting"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                            </StackPanel>
                            
                            <!-- Performance Guides Section -->
                            <StackPanel Grid.Row="0" Grid.Column="1" Margin="10,0,0,20">
                                <TextBlock Text="Performance Guides" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <Button Content="Performance Optimization" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="PerformanceOptimization"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="ENB Setup Guide" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="EnbSetup"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Graphics Mods Guide" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="GraphicsMods"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                            </StackPanel>
                            
                            <!-- Mod Management Section -->
                            <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,20">
                                <TextBlock Text="Mod Management" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <Button Content="Mod Organizer 2 Guide" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="Mo2Guide"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Vortex Guide" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="VortexGuide"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Load Order Optimization" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="LoadOrderGuide"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                            </StackPanel>
                            
                            <!-- Troubleshooting Section -->
                            <StackPanel Grid.Row="1" Grid.Column="1" Margin="10,0,0,20">
                                <TextBlock Text="Troubleshooting" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <Button Content="Common Crash Fixes" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="CrashFixes"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Plugin Conflict Resolution" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="PluginConflicts"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Save Game Troubleshooting" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="SaveGameIssues"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                            </StackPanel>
                            
                            <!-- Community Resources Section -->
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,0,10">
                                <TextBlock Text="Community Resources" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <Button Content="Discord Community" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="DiscordCommunity"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Reddit Community" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="RedditCommunity"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                                        
                                <Button Content="Nexus Mods Forums" 
                                        Command="{Binding OpenArticleCommand}" 
                                        CommandParameter="NexusForums"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Backups Tab -->
            <TabItem Header="Backups">
                <ScrollViewer>
                    <StackPanel Margin="20" MaxWidth="600">
                        <TextBlock Text="Backup and Restore Game Components" 
                                   FontWeight="Bold" 
                                   Margin="0,0,0,15" 
                                   FontSize="16"/>
                        
                        <!-- XSE Files Section -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" CornerRadius="5">
                            <Grid RowDefinitions="Auto,Auto">
                                <TextBlock Grid.Row="0" 
                                           Text="XSE (Script Extender) Files" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10">
                                    <Button Content="Backup" 
                                            Command="{Binding BackupFilesCommand}" 
                                            CommandParameter="XSE"/>
                                    <Button Content="Restore" 
                                            Command="{Binding RestoreFilesCommand}" 
                                            CommandParameter="XSE"/>
                                    <Button Content="Remove" 
                                            Command="{Binding RemoveFilesCommand}" 
                                            CommandParameter="XSE"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Reshade Files Section -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" CornerRadius="5">
                            <Grid RowDefinitions="Auto,Auto">
                                <TextBlock Grid.Row="0" 
                                           Text="Reshade Files" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10">
                                    <Button Content="Backup" 
                                            Command="{Binding BackupFilesCommand}" 
                                            CommandParameter="Reshade"/>
                                    <Button Content="Restore" 
                                            Command="{Binding RestoreFilesCommand}" 
                                            CommandParameter="Reshade"/>
                                    <Button Content="Remove" 
                                            Command="{Binding RemoveFilesCommand}" 
                                            CommandParameter="Reshade"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Vulkan Files Section -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" CornerRadius="5">
                            <Grid RowDefinitions="Auto,Auto">
                                <TextBlock Grid.Row="0" 
                                           Text="Vulkan Files" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10">
                                    <Button Content="Backup" 
                                            Command="{Binding BackupFilesCommand}" 
                                            CommandParameter="Vulkan"/>
                                    <Button Content="Restore" 
                                            Command="{Binding RestoreFilesCommand}" 
                                            CommandParameter="Vulkan"/>
                                    <Button Content="Remove" 
                                            Command="{Binding RemoveFilesCommand}" 
                                            CommandParameter="Vulkan"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- ENB Files Section -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" CornerRadius="5">
                            <Grid RowDefinitions="Auto,Auto">
                                <TextBlock Grid.Row="0" 
                                           Text="ENB Files" 
                                           FontWeight="Bold" 
                                           Margin="0,0,0,10"/>
                                
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10">
                                    <Button Content="Backup" 
                                            Command="{Binding BackupFilesCommand}" 
                                            CommandParameter="ENB"/>
                                    <Button Content="Restore" 
                                            Command="{Binding RestoreFilesCommand}" 
                                            CommandParameter="ENB"/>
                                    <Button Content="Remove" 
                                            Command="{Binding RemoveFilesCommand}" 
                                            CommandParameter="ENB"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Open Backups Folder Button -->
                        <Button Content="Open Vault Backups" 
                                Command="{Binding OpenBackupsFolderCommand}" 
                                HorizontalAlignment="Left" 
                                Margin="0,10,0,0" />
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
        
        <!-- Status Bar -->
        <Border Grid.Row="1" Background="#2D2D30" Padding="10" HorizontalAlignment="Stretch">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <!-- Left Side -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10">
                    <Button Content="Check Updates" Command="{Binding CheckUpdatesCommand}" />
                    <ToggleButton Content="Papyrus Monitoring" 
                                  IsChecked="{Binding IsPapyrusMonitoringEnabled}" 
                                  Command="{Binding TogglePapyrusMonitoringCommand}" />
                </StackPanel>
                
                <!-- Center - Status Text -->
                <TextBlock Grid.Column="1" Text="{Binding StatusText}" VerticalAlignment="Center" HorizontalAlignment="Center" />
                
                <!-- Right Side - Action Buttons -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="10">
                    <Button Content="?" 
                            ToolTip.Tip="Help"
                            Command="{Binding ShowHelpCommand}"
                            Width="30" Height="30"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            FontWeight="Bold" />
                    <Button Content="ⓘ" 
                            ToolTip.Tip="About Scanner111"
                            Command="{Binding ShowAboutCommand}"
                            Width="30" Height="30" 
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            FontWeight="Bold" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
