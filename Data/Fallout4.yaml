# THIS IS AN AI-GENERATED TEMPLATE, INFORMATION IS NOT ACCURATE YET!!!

# Scanner111 Game Configuration for Fallout 4
# Enhanced YAML schema for crash analysis and game integrity with variant support

# ===================================
# Game Variants Configuration
# ===================================
game_variants:
  # Standard Fallout 4
  Fallout4:
    id: "Fallout4"
    name: "Fallout 4"
    executables: ["Fallout4.exe"]
    steam_id: 377160
    script_extender: "F4SE"
    script_extender_version_minimum: "0.6.21"
    crash_generator: "Buffout4"
    crash_generator_version_minimum: "1.26.2"
    documents_path_suffix: "My Games/Fallout4"
    crash_log_path: "F4SE/Crash Logs"
    required_files:
      - path: "Fallout4.exe"
        description: "Main game executable"
        critical: true
      - path: "Fallout4.esm"
        description: "Main game master file"
        critical: true
      - path: "f4se_loader.exe"
        description: "Script Extender loader"
        critical: true
      - path: "Data/F4SE/Plugins/Buffout4.dll"
        description: "Crash log generator"
        critical: true
      - path: "Data/F4SE/Plugins/version-1-10-163-0.bin"
        description: "F4SE plugin compatibility file"
        critical: true
      - path: "Data/DLCList.txt"
        description: "DLC load list"
        critical: false
    incompatible_plugins:
      - "Fallout4VR.esp"
      - "F4NVR.esp"
      - "VRDestinations.esp"

  # Fallout 4 VR
  Fallout4VR:
    id: "Fallout4VR"
    name: "Fallout 4 VR"
    executables: ["Fallout4VR.exe"]
    steam_id: 611660
    script_extender: "F4SEVR"
    script_extender_version_minimum: "0.6.21"
    crash_generator: "Buffout4VR"
    crash_generator_version_minimum: "1.26.2"
    documents_path_suffix: "My Games/Fallout4VR"
    crash_log_path: "F4SEVR/Crash Logs"
    required_files:
      - path: "Fallout4VR.exe"
        description: "Main VR game executable"
        critical: true
      - path: "Fallout4.esm"
        description: "Main game master file"
        critical: true
      - path: "f4sevr_loader.exe"
        description: "VR Script Extender loader"
        critical: true
      - path: "Data/F4SEVR/Plugins/Buffout4VR.dll"
        description: "VR Crash log generator"
        critical: true
      - path: "Data/F4SEVR/Plugins/version-1-2-72-0.bin"
        description: "F4SEVR plugin compatibility file"
        critical: true
    incompatible_plugins:
      - "PhysicsExtensions.esp" # Example of VR-incompatible mod
      - "ClassicHolsteredWeapons.esp"
      - "Enhanced Blood Textures.esp"

  # Fallout 4 Next-Gen Update
  Fallout4NG:
    id: "Fallout4NG"
    name: "Fallout 4 (Next-Gen Update)"
    executables: ["Fallout4.exe"]
    steam_id: 377160
    notes: "This is the next-gen updated version"
    script_extender: "F4SE"
    script_extender_version_minimum: "0.7.0" # Hypothetically newer version
    crash_generator: "Buffout4"
    crash_generator_version_minimum: "1.28.0" # Hypothetically newer version
    documents_path_suffix: "My Games/Fallout4"
    crash_log_path: "F4SE/Crash Logs"
    required_files:
      - path: "Fallout4.exe"
        description: "Main game executable (Next-Gen)"
        critical: true
      - path: "Fallout4.esm"
        description: "Main game master file"
        critical: true
      - path: "f4se_loader.exe"
        description: "Script Extender loader"
        critical: true
      - path: "Data/F4SE/Plugins/Buffout4.dll"
        description: "Crash log generator"
        critical: true
      - path: "Data/F4SE/Plugins/version-1-11-0-0.bin" # Hypothetical new version
        description: "F4SE plugin compatibility file"
        critical: true
    incompatible_plugins:
      - "Unofficial Fallout 4 Patch.esp" # Until updated
      - "F4SE Plugin Preloader.dll" # Example of hypothetically incompatible mod

# ===================================
# Crash Log Filtering
# ===================================
crash_log_filtering:
  # Lines to exclude from the crash log analysis
  excluded_lines:
    - '""'
    - "..."
    - "FE:"
    - ".esl"
    - ".esm"
    - ".esp"
    - ".exe"
    - "Buffout4.dll+"
    - "KERNEL"
    - "USER32"
    - "Unhandled"
    - "cudart64_75.dll+"
    - "d3d11.dll+"
    - "f4se"
    - "ntdll"
    - "nvcuda64.dll+"
    - "nvwgf2umx.dll+"
  
  # Plugins to exclude from specific checks
  excluded_plugins:
    - "Fallout4.esm"
    - "Fallout4VR.esm"
    - "DLCCoast.esm"
    - "DLCNukaWorld.esm"
    - "DLCRobot.esm"
    - "DLCworkshop01.esm"
    - "DLCworkshop02.esm"
    - "DLCworkshop03.esm"
    - "Unofficial Fallout 4 Patch.esp"
    - "Buffout4.dll"
  
  # Patterns that disqualify a crash detection for specific categories
  disqualifying_patterns:
    # If these lines appear, don't report as a texture crash
    texture_crash:
      - text: "BSMeshLODTriShape"
        location: "anywhere"
    
    # If these lines appear, don't report as a mesh crash
    mesh_crash:
      - text: "LooseFileStream"
        location: "call_stack"
      - text: "BSTextureStreamerLocalHeap"
        location: "anywhere"
    
    # If these lines appear, don't report as an animation crash
    animation_crash:
      - text: "BGSEncounterManager"
        location: "call_stack"
      - text: "TESObjectCELL"
        location: "call_stack"
    
    # If these lines appear, don't report as a script crash
    script_crash:
      - text: "HHS.dll"
        location: "call_stack"
      - text: "AcceptanceHandler"
        location: "call_stack"

# ===================================
# Crash Analysis Patterns (Common across variants)
# ===================================
crash_patterns:
  # Main exception types
  exceptions:
    stack_overflow:
      signatures:
        - text: "EXCEPTION_STACK_OVERFLOW"
          location: "main_error"
      severity: 5
      description: "Stack Overflow Crash: Too many nested function calls or infinite recursion"
      mod_categories: ["script_heavy_mods"]
    
    access_violation:
      signatures:
        - text: "EXCEPTION_ACCESS_VIOLATION"
          location: "main_error"
      severity: 4
      description: "Memory Access Violation: Attempt to access invalid memory address"
      mod_categories: ["memory_mods", "animation_mods"]
  
  # Stack trace patterns
  stack_traces:
    texture_crash:
      ba2_limit:
        signatures:
          - text: "LooseFileAsyncStream"
            location: "call_stack"
        severity: 3
        description: "Plugin limit exceeded: Too many general archives loaded"
        mod_categories: [ "archive_management" ]
      
      signatures:
        - text: "BSTextureStreamerLocalHeap"
          location: "call_stack"
        - text: "TextureLoad"
          location: "anywhere"
      severity: 4
      description: "Texture-related crash: Likely due to texture overload or corruption"
      mod_categories: ["texture_mods", "memory_management"]
    
    animation_crash:
      signatures:
        - text: "AnimationFileData"
          location: "call_stack"
        - text: "AnimData"
          location: "call_stack"
      severity: 5
      description: "Animation corruption crash: Problem with animation files or skeleton"
      mod_categories: ["animation_mods", "body_mods"]
    
    scaleform_crash:
      signatures:
        - text: "Scaleform"
          location: "call_stack"
        - text: "GFx"
          location: "call_stack"
      severity: 3
      description: "UI-related crash (Scaleform): Problem with game interface"
      mod_categories: ["ui_mods"]
    
    nikson_crash:
      signatures:
        - text: "Buffout4.dll+OFFSET"
          location: "call_stack"
        - text: "HHS.dll"
          location: "call_stack"
      severity: 5
      description: "Crash related to Nikson's mods: AAF and other animation frameworks"
      mod_categories: ["animation_framework_mods"]
      applicable_variants: ["Fallout4", "Fallout4NG"] # Not applicable to VR
    
    physics_crash:
      signatures:
        - text: "havok"
          location: "call_stack"
        - text: "bhkWorld"
          location: "call_stack"
      severity: 4
      description: "Physics engine crash: Issues with game physics"
      mod_categories: ["physics_mods"]
    
    # VR-specific crashes
    vr_tracking_crash:
      signatures:
        - text: "OpenVR"
          location: "call_stack"
        - text: "SteamVR"
          location: "anywhere"
      severity: 4
      description: "VR tracking issue crash: Problem with VR tracking"
      mod_categories: ["vr_mods"]
      applicable_variants: ["Fallout4VR"] # Only applicable to VR

# ===================================
# Mod Categories
# ===================================
mod_categories:
  script_heavy_mods:
    description: "Mods that use heavy scripting and may cause stack overflows"
    mods:
      - "SimSettlements.esp"
      - "SimSettlements2.esm"
      - "WorkshopFramework.esm"
      - "SKE.esm"
      - "Uncapped Settlement Surplus.esp"
  
  memory_mods:
    description: "Mods that may cause memory issues"
    mods:
      - "EnhancedLights.esp"
      - "UltraInteriorLighting.esp"
      - "Extreme Particles Overhaul.esp"
      - "Vivid Fallout - All in One.esp"
  
  animation_mods:
    description: "Mods that modify animations and can cause related crashes"
    mods:
      - "ClassicHolsteredWeapons.esp"
      - "FO4_AnimationsByLeito.esp"
      - "BraveAnims.esp"
      - "ZeX-BodyGen-F.esp"
      - "ZeX-BodyGen-M.esp"
  
  vr_mods:
    description: "VR-specific mods that may cause issues"
    mods:
      - "VRDestinations.esp"
      - "VRInput.esp"
      - "ImmersiveScaling.esp"
      - "VRIK.esp"
    applicable_variants: ["Fallout4VR"]

# ===================================
# Known Problematic Mods (With variant-specific flags)
# ===================================
problematic_mods:
  ClassicHolsteredWeapons.esp:
    issues:
      - description: "Conflicts with body/skeleton mods"
        severity: 5
        issue_type: "conflict"
        applicable_variants: ["Fallout4", "Fallout4NG"]
        conflicting_mods:
          - "CBBE.esp"
          - "BodyTalk.esp"
          - "cbp.dll"
        solution: "Use a compatibility patch or disable one of the conflicting mods"
        patch_links:
          - "https://www.nexusmods.com/fallout4/articles/2496"
      - description: "Not compatible with VR"
        severity: 5
        issue_type: "incompatible"
        applicable_variants: ["Fallout4VR"]
        solution: "Disable this mod in VR"
  
  WeaponsFramework.esm:
    issues:
      - description: "Conflicts with Tactical Reload"
        severity: 4
        issue_type: "conflict"
        applicable_variants: ["Fallout4", "Fallout4NG", "Fallout4VR"]
        conflicting_mods:
          - "TacticalReload.esp"
        solution: "Use the compatibility patch"
        patch_links:
          - "https://www.nexusmods.com/fallout4/articles/3769"
  
  # NG-specific issues
  Unofficial Fallout 4 Patch.esp:
    issues:
      - description: "Not updated for Next-Gen Update"
        severity: 5
        issue_type: "incompatible"
        applicable_variants: ["Fallout4NG"]
        solution: "Wait for UFO4P to be updated for the Next-Gen Update"

# ===================================
# Variant-Specific Common Crash Solutions
# ===================================
variant_solutions:
  Fallout4:
    startup_crash:
      - "Verify game file integrity through Steam"
      - "Update F4SE to latest version"
      - "Disable mods and re-enable in batches"
  
  Fallout4VR:
    startup_crash:
      - "Verify game file integrity through Steam"
      - "Update F4SEVR to latest version"
      - "Check SteamVR is updated"
      - "Disable mods and re-enable in batches"
    tracking_issues:
      - "Reset room setup in SteamVR"
      - "Check for reflective surfaces in play area"
      - "Update graphics drivers"
  
  Fallout4NG:
    startup_crash:
      - "Verify game file integrity through Steam"
      - "Wait for F4SE to update for Next-Gen"
      - "Disable all mods until compatibility is confirmed"